\section{Link detection}
\label{sec:link-detection}

The link detection is the task of discovering \textit{hidden links} in a network. 
A link $(x,y)$ is an hidden link if it exists in reality, but not in the dataset because, tipically, it has been deliberately concelad for criminal pruposes.

We present here a local metric for link detection, based on the following criminological assumptions: 
(i) two criminal nodes hide their direct relation interposing some nodes between them, namely \textit{mediator nodes}, 
(ii) these nodes are mainly dedicated to let them interact.
(iii) the greater the number of these nodes, the greater the likelihood of hidden linkage. 

Formally, 
(i) a direct link $(x,y)$ can be hidden by a path $\pi=(x,z_{1},\ldots,z_{h},y)$, where $z_{1},\ldots,z_{h}$ are mediator nodes,
(ii) the weight $w_{z_{i}}$ of the interactions involving nodes $z_{i}$ is mainly dedicated to convey the hidden interaction passing through that node, that is $\frac{w_{x,z_{i}}+w_{z_{i},y}}{w_{z_{i}}} > 1- \frac{w_{x,z_{i}}+w_{z_{i},y}}{w_{z_{i}}}$.

Let us consider an undirected weighted graph $G(V,E,w)$ with $w:E\rightarrow\Re_{\geq1}^{+}$ and a pair of nodes $x,y\in V$.
We can build the following local metric:


\begin{equation}
\label{eqn:detection-local}
\Phi(x,y)=
\frac{\sum\limits_{z\in\Gamma_{x,y}}(w_{x,z}+w_{z,y})w_{z}^{-1}}
{\sum\limits_{z\in\Gamma_{x,y}}w_{z}}
\end{equation}

where 
$\Gamma_{x,y}$ is the set of common neighbours between $x$ and $y$,
$w_{x,z}$ is the weight of the edge $(x,z)$ and
$w_{z}$ is the total weight of the edges incident to $z$.

The metric produces a normalized score $\Phi(x,y)\in(0,1)$, hence it is suitable for thresholding.
Given an arbitrary threshold $\tilde{\Phi}$, every edge $(x,y)$ such that $\Phi(x,y)\geq\tilde{\Phi}$ is considered an hidden link with a probability proportional to the score achieved.
Since $\Phi$ is strictly related to the edge weights, the threshold must be chosen according to the maximum and minimum weights observed on the graph.

The Equation~\ref{eqn:detection-local} can be extended to the following quasi-local metric.

Let us now consider an undirected weighted graph $G$ with $w:E\rightarrow\Re_{\geq1}^{+}$, a pair of nodes $x,y\in V$, a locality degree $t\in \mathbb{Z}$, $t\geq 1$, and a vector $\vec{\lambda}=(\lambda_{1}\ldots\lambda_{t})$ such that $\sum_{i=1}^{t}\lambda_{i}=1$.
We can build the following quasi-local metric:

\begin{equation}
\label{eqn:detection-quasi-local-1}
\Phi_{QL}(x,y,t,\vec{\lambda})=\vec{\lambda}\cdot\vec{\Phi}_{QL}(x,y,t)
\end{equation}

where $\vec{\Phi}_{QL}(x,y,t)=(\Phi_{QL}(x,y,1)\ldots\Phi_{QL}(x,y,t))$ is a vector of scores with every element defined as follows:
\begin{equation}
\label{eqn:detection-quasi-local-2}
\Phi_{QL}(x,y,i)=
\frac{\sum\limits_{\pi\in\Pi_{x,y}^{(i+1)}}w_{\pi}}
{\sum\limits_{z\in\pi\in\Pi_{x,y}^{(i+1)}}w_{z}}
\end{equation}

where $\Pi_{x,y}^{(i)}$ is the set of paths between $x$ and $y$ of lenght $i$,
$w_{\pi}$ is the weight of path $\pi$ and
$w_{z}$ is the total weight of edges incident to $z$.

The metric produces a normalized score $\Phi_{QL}(x,y,t,\vec{\lambda})\in(0,1)$, hence thold here he same considerations about thresholding stated for the local metric.